# 合约升级模式

在上一章节中，已经介绍了代理合约的实现原理。代理合约主要扮演着用户交互的界面，所有的调用都经过它，然后被转发到背后的逻辑合约。逻辑合约包含了逻辑和数据处理的实际代码，而代理合约则通过特定的模式，如 `delegatecall`，调用这些逻辑。

这一章节中，将介绍主要代理的模式类型

## 主要的代理模式类型

1. 透明代理模式

这一模式下，一个中央透明代理处理所有合约调用的转发，并决定是否根据用户的身份（如管理员与普通用户）来限制访问级别。这种模式的优点是简化了权限管理，缺点则在于可能增加了一定的复杂性与额外的开销。

2. UUPS (Universal Upgradeable Proxy Standard，通用可升级代理标准)

UUPS 是一种更为高效的升级模式。它避免了额外的代理层，并整合了升级逻辑到实现合约内部。通过这种方式，升级操作更为直接，并且只有实现合约需要被替换，从而减少了出错的可能性。

3. Beacon 合约升级模式

Beacon 合约作为一个中央存储点，存储当前实现合约的地址，并由一系列的 Beacon 代理合约查询此地址进行操作。主要优点是对于多个依赖同一逻辑的代理合约，可以集中管理和升级。这大大简化了维护工作，尤其适用于大型应用场景。

接下来一一进行介绍

## 透明代理模式
在 Solidity 智能合约开发中，利用透明代理模式进行合约升级是一种有效的策略。

OpenZeppelin 提供了一套完备的工具和合约库，极大地简化了透明代理模式的实现，同时提供了额外的安全保障。这里我们将结合 OpenZeppelin 来展示如何实现透明代理模式。

### 关键概念

透明代理模式包括三个主要组件：

1. 逻辑合约（Logic Contract）：这是包含实际业务逻辑的合约。它的代码可以根据需要进行升级。
2. 代理合约（Proxy Contract）：这是用户交互的合约地址，固定不变。它内部不实际处理任何逻辑，而是将所有请求委托（delegatecall）给后端的逻辑合约。这样，即使逻辑合约发生更新，用户依然通过同一个代理合约地址与系统交互。
3. 代理管理合约（Proxy Admin Contract）：用于管理透明代理的合约，包括升级逻辑合约的地址。此外，它还可以有功能来处理权限管理，确保只有授权的操作者可以更新逻辑合约。
